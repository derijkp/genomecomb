#!/bin/sh
# the next line restarts using wish \
exec tclsh "$0" "$@"

source tools.tcl

test index {maketabix} {
	test_cleantmp
	file copy data/annot_compar-exomes_yri_parts.tsv tmp/test.tsv
	cg_maketabix tmp/test.tsv
	tabix tmp/test.tsv.gz 17 25267805 25267900
} {{17	25267807	25267808	snp	T	G	u	u	G	G	12.77	0	1;1	5	2	7	3	39,3,0	0.000	7		0.00	0.000	2.6000	14.36	1	0.253	1.82	1.111	2.303		u	u	T	T	10.4344	0	0;0	19	7	0			7	0.14	0	0.7	0.7	1	-0.453602	0.142857	0.664375		1	14	-24.1103	1,1,1,0.00148155	3,2,2,0	?	u	u	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	u	u	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	u	u	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	u	u	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?					(GAGTG)n	1188	-	-}}

test index {maketabix zst} {
	test_cleantmp
	exec cat data/annot_compar-exomes_yri_parts.tsv | cg zst  > tmp/test.tsv.zst
	cg_maketabix tmp/test.tsv.zst
	tabix tmp/test.tsv.gz 17 25267805 25267900
} {{17	25267807	25267808	snp	T	G	u	u	G	G	12.77	0	1;1	5	2	7	3	39,3,0	0.000	7		0.00	0.000	2.6000	14.36	1	0.253	1.82	1.111	2.303		u	u	T	T	10.4344	0	0;0	19	7	0			7	0.14	0	0.7	0.7	1	-0.453602	0.142857	0.664375		1	14	-24.1103	1,1,1,0.00148155	3,2,2,0	?	u	u	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	u	u	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	u	u	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	u	u	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?					(GAGTG)n	1188	-	-}}

test index {maketabix vcf} {
	test_cleantmp
	cg select -f {chromosome begin end type ref alt} data/annot_compar-exomes_yri_parts.tsv | cg tsv2vcf -refseq $::refseqdir/hg19 > tmp/test.vcf
	cg_maketabix tmp/test.vcf
	tabix tmp/test.vcf.gz 17 25267805 25267900
} {{17	25267808	.	T	G	.	.	.	GT}}

test index {maketabix bed} {
	test_cleantmp
	cg tsv2bed data/annot_compar-exomes_yri_parts.tsv tmp/test.bed
	cg_maketabix tmp/test.bed
	tabix tmp/test.bed.gz 17 25267805 25267900
} {{17	25267807	25267808}}

test index {maketabix_job} {
	test_cleantmp
	exec cat data/annot_compar-exomes_yri_parts.tsv | cg gzip  > tmp/test.tsv.gz
	job_init -d 0
	maketabix_job tmp/test.tsv.gz
	job_wait
	tabix tmp/test.tsv.gz 17 25267805 25267900
} {{17	25267807	25267808	snp	T	G	u	u	G	G	12.77	0	1;1	5	2	7	3	39,3,0	0.000	7		0.00	0.000	2.6000	14.36	1	0.253	1.82	1.111	2.303		u	u	T	T	10.4344	0	0;0	19	7	0			7	0.14	0	0.7	0.7	1	-0.453602	0.142857	0.664375		1	14	-24.1103	1,1,1,0.00148155	3,2,2,0	?	u	u	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	u	u	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	u	u	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	u	u	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?	?					(GAGTG)n	1188	-	-}}

testsummarize


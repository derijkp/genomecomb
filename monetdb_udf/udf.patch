diff -rupN UDF.ori/80_udf.sql UDF/80_udf.sql
--- UDF.ori/80_udf.sql	2014-01-14 09:56:40.000000000 +0100
+++ UDF/80_udf.sql	2014-10-10 19:17:45.462828273 +0200
@@ -34,3 +34,11 @@ returns integer external name udf.fuse;
 -- fuse two (4-byte) integer values into one (8-byte) bigint value
 create function fuse(one integer, two integer)
 returns bigint external name udf.fuse;
+
+-- lmin
+create function lmin(src string)
+returns string external name udf.lmin;
+
+-- lmax
+create function lmax(src string)
+returns string external name udf.lmax;
diff -rupN UDF.ori/Makefile.ag UDF/Makefile.ag
--- UDF.ori/Makefile.ag	2014-01-14 09:56:23.000000000 +0100
+++ UDF/Makefile.ag	2014-10-10 19:18:34.347435829 +0200
@@ -33,7 +33,7 @@ INCLUDES = .. \
 lib__udf = {
 	MODULE
 	DIR = libdir/monetdb5
-	SOURCES = udf.c udf.h udf_impl.h
+	SOURCES = udf.c udf.h udf-cg.c udf-cg.h udf_impl.h
 	LIBS = ../../../../monetdb5/tools/libmonetdb5 \
 		   ../../../../gdk/libbat
 }
diff -rupN UDF.ori/Makefile.am UDF/Makefile.am
--- UDF.ori/Makefile.am	2014-07-25 15:10:12.000000000 +0200
+++ UDF/Makefile.am	2014-10-10 19:28:49.635124009 +0200
@@ -13,6 +13,7 @@ install-exec-local-80_udf.mal: 80_udf.ma
 uninstall-local-80_udf.mal: 
 	$(RM) $(DESTDIR)$(libdir)/monetdb5/autoload/80_udf.mal
 
+udf-cg.o udf-cg.lo: udf-cg.c udf-cg.h ../../../include/sql_mem.h ../mal_backend.h ../../../server/sql_mvc.h ../../../server/../include/sql_mem.h ../../../server/../../gdk/gdk.h ../../../server/sql_scan.h ../../../server/../include/sql_list.h ../../../server/../../common/stream/stream.h ../../../server/../common/sql_types.h ../../../server/../common/sql_backend.h ../../../server/../include/sql_catalog.h ../../../server/../include/sql_relation.h ../../../server/../storage/sql_storage.h ../../../server/../include/sql_keyword.h ../../../server/sql_atom.h ../../../server/../../clients/mapilib/mapi.h ../../../common/sql_backend.h ../../../common/../include/sql_mem.h ../../../common/../include/sql_catalog.h ../../../common/../include/sql_relation.h ../../../common/sql_types.h ../../../common/../include/sql_list.h ../../../common/sql_string.h ../../../common/../storage/sql_storage.h ../../../common/../../common/stream/stream.h ../../../../monetdb5/mal/mal_session.h ../../../../monetdb5/mal/mal_scenario.h ../../../../monetdb5/mal/mal_import.h ../../../../monetdb5/mal/mal_function.h ../../../../monetdb5/mal/mal_module.h ../../../../monetdb5/mal/mal_resolve.h ../../../../monetdb5/mal/mal_exception.h ../../../../monetdb5/mal/mal_instruction.h ../../../../monetdb5/mal/mal_type.h ../../../../monetdb5/mal/mal.h ../../../../monetdb5/mal/../../gdk/gdk.h ../../../../monetdb5/mal/mal_stack.h ../../../../monetdb5/mal/mal_properties.h ../../../../monetdb5/mal/mal_namespace.h ../../../../monetdb5/mal/mal_errors.h ../../../../monetdb5/mal/mal_interpreter.h ../../../../monetdb5/modules/mal/tablet.h ../../../../monetdb5/modules/atoms/streams.h ../../../../monetdb5/modules/atoms/../../mal/mal.h ../../../../monetdb5/modules/atoms/../../../common/stream/stream_socket.h ../../../../monetdb5/modules/atoms/mtime.h ../../../../monetdb5/modules/atoms/../../../gdk/gdk.h ../../../../monetdb5/modules/atoms/../../mal/mal_exception.h ../../../../monetdb5/modules/atoms/blob.h ../../../../monetdb5/modules/mal/mkey.h ../../../../monetdb5/modules/atoms/str.h ../../../server/sql_privileges.h ../../../server/sql_decimal.h ../../../server/sql_qc.h ../../../server/sql_symbol.h ../../../server/sql_env.h ../../../server/sql_parser.h ../sql_statement.h ../../../../monetdb5/modules/mal/querylog.h ../../../storage/bat/bat_storage.h ../../../storage/bat/bat_utils.h ../sql_cast.h ../sql.h udf_impl.h
 udf.o udf.lo: udf.c udf.h ../../../include/sql_mem.h ../mal_backend.h ../../../server/sql_mvc.h ../../../server/../include/sql_mem.h ../../../server/../../gdk/gdk.h ../../../server/sql_scan.h ../../../server/../include/sql_list.h ../../../server/../../common/stream/stream.h ../../../server/../common/sql_types.h ../../../server/../common/sql_backend.h ../../../server/../include/sql_catalog.h ../../../server/../include/sql_relation.h ../../../server/../storage/sql_storage.h ../../../server/../include/sql_keyword.h ../../../server/sql_atom.h ../../../server/../../clients/mapilib/mapi.h ../../../common/sql_backend.h ../../../common/../include/sql_mem.h ../../../common/../include/sql_catalog.h ../../../common/../include/sql_relation.h ../../../common/sql_types.h ../../../common/../include/sql_list.h ../../../common/sql_string.h ../../../common/../storage/sql_storage.h ../../../common/../../common/stream/stream.h ../../../../monetdb5/mal/mal_session.h ../../../../monetdb5/mal/mal_scenario.h ../../../../monetdb5/mal/mal_import.h ../../../../monetdb5/mal/mal_function.h ../../../../monetdb5/mal/mal_module.h ../../../../monetdb5/mal/mal_resolve.h ../../../../monetdb5/mal/mal_exception.h ../../../../monetdb5/mal/mal_instruction.h ../../../../monetdb5/mal/mal_type.h ../../../../monetdb5/mal/mal.h ../../../../monetdb5/mal/../../gdk/gdk.h ../../../../monetdb5/mal/mal_stack.h ../../../../monetdb5/mal/mal_properties.h ../../../../monetdb5/mal/mal_namespace.h ../../../../monetdb5/mal/mal_errors.h ../../../../monetdb5/mal/mal_interpreter.h ../../../../monetdb5/modules/mal/tablet.h ../../../../monetdb5/modules/atoms/streams.h ../../../../monetdb5/modules/atoms/../../mal/mal.h ../../../../monetdb5/modules/atoms/../../../common/stream/stream_socket.h ../../../../monetdb5/modules/atoms/mtime.h ../../../../monetdb5/modules/atoms/../../../gdk/gdk.h ../../../../monetdb5/modules/atoms/../../mal/mal_exception.h ../../../../monetdb5/modules/atoms/blob.h ../../../../monetdb5/modules/mal/mkey.h ../../../../monetdb5/modules/atoms/str.h ../../../server/sql_privileges.h ../../../server/sql_decimal.h ../../../server/sql_qc.h ../../../server/sql_symbol.h ../../../server/sql_env.h ../../../server/sql_parser.h ../sql_statement.h ../../../../monetdb5/modules/mal/querylog.h ../../../storage/bat/bat_storage.h ../../../storage/bat/bat_utils.h ../sql_cast.h ../sql.h udf_impl.h
 install-exec-local-udf.mal: udf.mal
 	-mkdir -p $(DESTDIR)$(libdir)/monetdb5
@@ -37,15 +38,17 @@ lib_udf_la_LIBADD = ../../../../monetdb5
 $(do)install-udfLTLIBRARIES : 
 lib_udf_la-udf.lo: udf.c udf.h ../../../include/sql_mem.h ../mal_backend.h ../../../server/sql_mvc.h ../../../server/../include/sql_mem.h ../../../server/../../gdk/gdk.h ../../../server/sql_scan.h ../../../server/../include/sql_list.h ../../../server/../../common/stream/stream.h ../../../server/../common/sql_types.h ../../../server/../common/sql_backend.h ../../../server/../include/sql_catalog.h ../../../server/../include/sql_relation.h ../../../server/../storage/sql_storage.h ../../../server/../include/sql_keyword.h ../../../server/sql_atom.h ../../../server/../../clients/mapilib/mapi.h ../../../common/sql_backend.h ../../../common/../include/sql_mem.h ../../../common/../include/sql_catalog.h ../../../common/../include/sql_relation.h ../../../common/sql_types.h ../../../common/../include/sql_list.h ../../../common/sql_string.h ../../../common/../storage/sql_storage.h ../../../common/../../common/stream/stream.h ../../../../monetdb5/mal/mal_session.h ../../../../monetdb5/mal/mal_scenario.h ../../../../monetdb5/mal/mal_import.h ../../../../monetdb5/mal/mal_function.h ../../../../monetdb5/mal/mal_module.h ../../../../monetdb5/mal/mal_resolve.h ../../../../monetdb5/mal/mal_exception.h ../../../../monetdb5/mal/mal_instruction.h ../../../../monetdb5/mal/mal_type.h ../../../../monetdb5/mal/mal.h ../../../../monetdb5/mal/../../gdk/gdk.h ../../../../monetdb5/mal/mal_stack.h ../../../../monetdb5/mal/mal_properties.h ../../../../monetdb5/mal/mal_namespace.h ../../../../monetdb5/mal/mal_errors.h ../../../../monetdb5/mal/mal_interpreter.h ../../../../monetdb5/modules/mal/tablet.h ../../../../monetdb5/modules/atoms/streams.h ../../../../monetdb5/modules/atoms/../../mal/mal.h ../../../../monetdb5/modules/atoms/../../../common/stream/stream_socket.h ../../../../monetdb5/modules/atoms/mtime.h ../../../../monetdb5/modules/atoms/../../../gdk/gdk.h ../../../../monetdb5/modules/atoms/../../mal/mal_exception.h ../../../../monetdb5/modules/atoms/blob.h ../../../../monetdb5/modules/mal/mkey.h ../../../../monetdb5/modules/atoms/str.h ../../../server/sql_privileges.h ../../../server/sql_decimal.h ../../../server/sql_qc.h ../../../server/sql_symbol.h ../../../server/sql_env.h ../../../server/sql_parser.h ../sql_statement.h ../../../../monetdb5/modules/mal/querylog.h ../../../storage/bat/bat_storage.h ../../../storage/bat/bat_utils.h ../sql_cast.h ../sql.h udf_impl.h
 	$(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(lib_udf_la_CFLAGS) $(CFLAGS) $(udf_CFLAGS) -c -o lib_udf_la-udf.lo `test -f 'udf.c' || echo '$(srcdir)/'`udf.c
+lib_udf_la-udf-cg.lo: udf-cg.c udf-cg.h ../../../include/sql_mem.h ../mal_backend.h ../../../server/sql_mvc.h ../../../server/../include/sql_mem.h ../../../server/../../gdk/gdk.h ../../../server/sql_scan.h ../../../server/../include/sql_list.h ../../../server/../../common/stream/stream.h ../../../server/../common/sql_types.h ../../../server/../common/sql_backend.h ../../../server/../include/sql_catalog.h ../../../server/../include/sql_relation.h ../../../server/../storage/sql_storage.h ../../../server/../include/sql_keyword.h ../../../server/sql_atom.h ../../../server/../../clients/mapilib/mapi.h ../../../common/sql_backend.h ../../../common/../include/sql_mem.h ../../../common/../include/sql_catalog.h ../../../common/../include/sql_relation.h ../../../common/sql_types.h ../../../common/../include/sql_list.h ../../../common/sql_string.h ../../../common/../storage/sql_storage.h ../../../common/../../common/stream/stream.h ../../../../monetdb5/mal/mal_session.h ../../../../monetdb5/mal/mal_scenario.h ../../../../monetdb5/mal/mal_import.h ../../../../monetdb5/mal/mal_function.h ../../../../monetdb5/mal/mal_module.h ../../../../monetdb5/mal/mal_resolve.h ../../../../monetdb5/mal/mal_exception.h ../../../../monetdb5/mal/mal_instruction.h ../../../../monetdb5/mal/mal_type.h ../../../../monetdb5/mal/mal.h ../../../../monetdb5/mal/../../gdk/gdk.h ../../../../monetdb5/mal/mal_stack.h ../../../../monetdb5/mal/mal_properties.h ../../../../monetdb5/mal/mal_namespace.h ../../../../monetdb5/mal/mal_errors.h ../../../../monetdb5/mal/mal_interpreter.h ../../../../monetdb5/modules/mal/tablet.h ../../../../monetdb5/modules/atoms/streams.h ../../../../monetdb5/modules/atoms/../../mal/mal.h ../../../../monetdb5/modules/atoms/../../../common/stream/stream_socket.h ../../../../monetdb5/modules/atoms/mtime.h ../../../../monetdb5/modules/atoms/../../../gdk/gdk.h ../../../../monetdb5/modules/atoms/../../mal/mal_exception.h ../../../../monetdb5/modules/atoms/blob.h ../../../../monetdb5/modules/mal/mkey.h ../../../../monetdb5/modules/atoms/str.h ../../../server/sql_privileges.h ../../../server/sql_decimal.h ../../../server/sql_qc.h ../../../server/sql_symbol.h ../../../server/sql_env.h ../../../server/sql_parser.h ../sql_statement.h ../../../../monetdb5/modules/mal/querylog.h ../../../storage/bat/bat_storage.h ../../../storage/bat/bat_utils.h ../sql_cast.h ../sql.h udf_impl.h
+	$(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(lib_udf_la_CFLAGS) $(CFLAGS) $(udf-cg_CFLAGS) -c -o lib_udf_la-udf-cg.lo `test -f 'udf-cg.c' || echo '$(srcdir)/'`udf-cg.c
 nodist_lib_udf_la_SOURCES =
-dist_lib_udf_la_SOURCES = udf.c udf.h udf_impl.h
+dist_lib_udf_la_SOURCES = udf.c udf.h udf-cg.c udf-cg.h udf_impl.h
 lib_udf_la_LDFLAGS = -module -avoid-version
 dist-hook:
 	mkdir -p $(distdir)/Tests
 	cp -pR $(srcdir)/Tests/* $(distdir)/Tests
 BUILT_SOURCES =
 MOSTLYCLEANFILES =
-EXTRA_DIST = Makefile.ag Makefile.msc 80_udf.mal 80_udf.sql udf.c udf.h udf.mal udf_impl.h
+EXTRA_DIST = Makefile.ag Makefile.msc 80_udf.mal 80_udf.sql udf-cg.c udf-cg.h udf.c udf.h udf.mal udf_impl.h
 udf_LTLIBRARIES = lib_udf.la
 uninstall-local: uninstall-local-80_udf.mal uninstall-local-80_udf.sql uninstall-local-udf.mal
 install-exec-local: install-exec-local-80_udf.mal install-exec-local-80_udf.sql install-exec-local-udf.mal
diff -rupN UDF.ori/Makefile.in UDF/Makefile.in
--- UDF.ori/Makefile.in	2014-07-25 15:10:22.000000000 +0200
+++ UDF/Makefile.in	2014-10-10 19:35:29.200129797 +0200
@@ -125,7 +125,7 @@ am__installdirs = "$(DESTDIR)$(udfdir)"
 LTLIBRARIES = $(udf_LTLIBRARIES)
 lib_udf_la_DEPENDENCIES = ../../../../monetdb5/tools/libmonetdb5.la \
 	../../../../gdk/libbat.la
-dist_lib_udf_la_OBJECTS = lib_udf_la-udf.lo
+dist_lib_udf_la_OBJECTS = lib_udf_la-udf.lo lib_udf_la-udf-cg.lo
 nodist_lib_udf_la_OBJECTS =
 lib_udf_la_OBJECTS = $(dist_lib_udf_la_OBJECTS) \
 	$(nodist_lib_udf_la_OBJECTS)
@@ -482,11 +482,11 @@ lib_udf_la_CFLAGS = -DLIBUDF $(AM_CFLAGS
 udfdir = $(libdir)/monetdb5
 lib_udf_la_LIBADD = ../../../../monetdb5/tools/libmonetdb5.la ../../../../gdk/libbat.la
 nodist_lib_udf_la_SOURCES = 
-dist_lib_udf_la_SOURCES = udf.c udf.h udf_impl.h
+dist_lib_udf_la_SOURCES = udf.c udf.h udf-cg.c udf-cg.h udf_impl.h
 lib_udf_la_LDFLAGS = -module -avoid-version
 BUILT_SOURCES = 
 MOSTLYCLEANFILES = 
-EXTRA_DIST = Makefile.ag Makefile.msc 80_udf.mal 80_udf.sql udf.c udf.h udf.mal udf_impl.h
+EXTRA_DIST = Makefile.ag Makefile.msc 80_udf.mal 80_udf.sql udf-cg.c udf-cg.h udf.c udf.h udf.mal udf_impl.h
 udf_LTLIBRARIES = lib_udf.la
 all: $(BUILT_SOURCES)
 	$(MAKE) $(AM_MAKEFLAGS) all-am
@@ -805,6 +805,7 @@ install-exec-local-80_udf.mal: 80_udf.ma
 uninstall-local-80_udf.mal: 
 	$(RM) $(DESTDIR)$(libdir)/monetdb5/autoload/80_udf.mal
 
+udf-cg.o udf-cg.lo: udf-cg.c udf-cg.h ../../../include/sql_mem.h ../mal_backend.h ../../../server/sql_mvc.h ../../../server/../include/sql_mem.h ../../../server/../../gdk/gdk.h ../../../server/sql_scan.h ../../../server/../include/sql_list.h ../../../server/../../common/stream/stream.h ../../../server/../common/sql_types.h ../../../server/../common/sql_backend.h ../../../server/../include/sql_catalog.h ../../../server/../include/sql_relation.h ../../../server/../storage/sql_storage.h ../../../server/../include/sql_keyword.h ../../../server/sql_atom.h ../../../server/../../clients/mapilib/mapi.h ../../../common/sql_backend.h ../../../common/../include/sql_mem.h ../../../common/../include/sql_catalog.h ../../../common/../include/sql_relation.h ../../../common/sql_types.h ../../../common/../include/sql_list.h ../../../common/sql_string.h ../../../common/../storage/sql_storage.h ../../../common/../../common/stream/stream.h ../../../../monetdb5/mal/mal_session.h ../../../../monetdb5/mal/mal_scenario.h ../../../../monetdb5/mal/mal_import.h ../../../../monetdb5/mal/mal_function.h ../../../../monetdb5/mal/mal_module.h ../../../../monetdb5/mal/mal_resolve.h ../../../../monetdb5/mal/mal_exception.h ../../../../monetdb5/mal/mal_instruction.h ../../../../monetdb5/mal/mal_type.h ../../../../monetdb5/mal/mal.h ../../../../monetdb5/mal/../../gdk/gdk.h ../../../../monetdb5/mal/mal_stack.h ../../../../monetdb5/mal/mal_properties.h ../../../../monetdb5/mal/mal_namespace.h ../../../../monetdb5/mal/mal_errors.h ../../../../monetdb5/mal/mal_interpreter.h ../../../../monetdb5/modules/mal/tablet.h ../../../../monetdb5/modules/atoms/streams.h ../../../../monetdb5/modules/atoms/../../mal/mal.h ../../../../monetdb5/modules/atoms/../../../common/stream/stream_socket.h ../../../../monetdb5/modules/atoms/mtime.h ../../../../monetdb5/modules/atoms/../../../gdk/gdk.h ../../../../monetdb5/modules/atoms/../../mal/mal_exception.h ../../../../monetdb5/modules/atoms/blob.h ../../../../monetdb5/modules/mal/mkey.h ../../../../monetdb5/modules/atoms/str.h ../../../server/sql_privileges.h ../../../server/sql_decimal.h ../../../server/sql_qc.h ../../../server/sql_symbol.h ../../../server/sql_env.h ../../../server/sql_parser.h ../sql_statement.h ../../../../monetdb5/modules/mal/querylog.h ../../../storage/bat/bat_storage.h ../../../storage/bat/bat_utils.h ../sql_cast.h ../sql.h udf_impl.h
 udf.o udf.lo: udf.c udf.h ../../../include/sql_mem.h ../mal_backend.h ../../../server/sql_mvc.h ../../../server/../include/sql_mem.h ../../../server/../../gdk/gdk.h ../../../server/sql_scan.h ../../../server/../include/sql_list.h ../../../server/../../common/stream/stream.h ../../../server/../common/sql_types.h ../../../server/../common/sql_backend.h ../../../server/../include/sql_catalog.h ../../../server/../include/sql_relation.h ../../../server/../storage/sql_storage.h ../../../server/../include/sql_keyword.h ../../../server/sql_atom.h ../../../server/../../clients/mapilib/mapi.h ../../../common/sql_backend.h ../../../common/../include/sql_mem.h ../../../common/../include/sql_catalog.h ../../../common/../include/sql_relation.h ../../../common/sql_types.h ../../../common/../include/sql_list.h ../../../common/sql_string.h ../../../common/../storage/sql_storage.h ../../../common/../../common/stream/stream.h ../../../../monetdb5/mal/mal_session.h ../../../../monetdb5/mal/mal_scenario.h ../../../../monetdb5/mal/mal_import.h ../../../../monetdb5/mal/mal_function.h ../../../../monetdb5/mal/mal_module.h ../../../../monetdb5/mal/mal_resolve.h ../../../../monetdb5/mal/mal_exception.h ../../../../monetdb5/mal/mal_instruction.h ../../../../monetdb5/mal/mal_type.h ../../../../monetdb5/mal/mal.h ../../../../monetdb5/mal/../../gdk/gdk.h ../../../../monetdb5/mal/mal_stack.h ../../../../monetdb5/mal/mal_properties.h ../../../../monetdb5/mal/mal_namespace.h ../../../../monetdb5/mal/mal_errors.h ../../../../monetdb5/mal/mal_interpreter.h ../../../../monetdb5/modules/mal/tablet.h ../../../../monetdb5/modules/atoms/streams.h ../../../../monetdb5/modules/atoms/../../mal/mal.h ../../../../monetdb5/modules/atoms/../../../common/stream/stream_socket.h ../../../../monetdb5/modules/atoms/mtime.h ../../../../monetdb5/modules/atoms/../../../gdk/gdk.h ../../../../monetdb5/modules/atoms/../../mal/mal_exception.h ../../../../monetdb5/modules/atoms/blob.h ../../../../monetdb5/modules/mal/mkey.h ../../../../monetdb5/modules/atoms/str.h ../../../server/sql_privileges.h ../../../server/sql_decimal.h ../../../server/sql_qc.h ../../../server/sql_symbol.h ../../../server/sql_env.h ../../../server/sql_parser.h ../sql_statement.h ../../../../monetdb5/modules/mal/querylog.h ../../../storage/bat/bat_storage.h ../../../storage/bat/bat_utils.h ../sql_cast.h ../sql.h udf_impl.h
 install-exec-local-udf.mal: udf.mal
 	-mkdir -p $(DESTDIR)$(libdir)/monetdb5
@@ -824,6 +825,8 @@ uninstall-local-80_udf.sql:
 $(do)install-udfLTLIBRARIES : 
 lib_udf_la-udf.lo: udf.c udf.h ../../../include/sql_mem.h ../mal_backend.h ../../../server/sql_mvc.h ../../../server/../include/sql_mem.h ../../../server/../../gdk/gdk.h ../../../server/sql_scan.h ../../../server/../include/sql_list.h ../../../server/../../common/stream/stream.h ../../../server/../common/sql_types.h ../../../server/../common/sql_backend.h ../../../server/../include/sql_catalog.h ../../../server/../include/sql_relation.h ../../../server/../storage/sql_storage.h ../../../server/../include/sql_keyword.h ../../../server/sql_atom.h ../../../server/../../clients/mapilib/mapi.h ../../../common/sql_backend.h ../../../common/../include/sql_mem.h ../../../common/../include/sql_catalog.h ../../../common/../include/sql_relation.h ../../../common/sql_types.h ../../../common/../include/sql_list.h ../../../common/sql_string.h ../../../common/../storage/sql_storage.h ../../../common/../../common/stream/stream.h ../../../../monetdb5/mal/mal_session.h ../../../../monetdb5/mal/mal_scenario.h ../../../../monetdb5/mal/mal_import.h ../../../../monetdb5/mal/mal_function.h ../../../../monetdb5/mal/mal_module.h ../../../../monetdb5/mal/mal_resolve.h ../../../../monetdb5/mal/mal_exception.h ../../../../monetdb5/mal/mal_instruction.h ../../../../monetdb5/mal/mal_type.h ../../../../monetdb5/mal/mal.h ../../../../monetdb5/mal/../../gdk/gdk.h ../../../../monetdb5/mal/mal_stack.h ../../../../monetdb5/mal/mal_properties.h ../../../../monetdb5/mal/mal_namespace.h ../../../../monetdb5/mal/mal_errors.h ../../../../monetdb5/mal/mal_interpreter.h ../../../../monetdb5/modules/mal/tablet.h ../../../../monetdb5/modules/atoms/streams.h ../../../../monetdb5/modules/atoms/../../mal/mal.h ../../../../monetdb5/modules/atoms/../../../common/stream/stream_socket.h ../../../../monetdb5/modules/atoms/mtime.h ../../../../monetdb5/modules/atoms/../../../gdk/gdk.h ../../../../monetdb5/modules/atoms/../../mal/mal_exception.h ../../../../monetdb5/modules/atoms/blob.h ../../../../monetdb5/modules/mal/mkey.h ../../../../monetdb5/modules/atoms/str.h ../../../server/sql_privileges.h ../../../server/sql_decimal.h ../../../server/sql_qc.h ../../../server/sql_symbol.h ../../../server/sql_env.h ../../../server/sql_parser.h ../sql_statement.h ../../../../monetdb5/modules/mal/querylog.h ../../../storage/bat/bat_storage.h ../../../storage/bat/bat_utils.h ../sql_cast.h ../sql.h udf_impl.h
 	$(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(lib_udf_la_CFLAGS) $(CFLAGS) $(udf_CFLAGS) -c -o lib_udf_la-udf.lo `test -f 'udf.c' || echo '$(srcdir)/'`udf.c
+lib_udf_la-udf-cg.lo: udf-cg.c udf-cg.h ../../../include/sql_mem.h ../mal_backend.h ../../../server/sql_mvc.h ../../../server/../include/sql_mem.h ../../../server/../../gdk/gdk.h ../../../server/sql_scan.h ../../../server/../include/sql_list.h ../../../server/../../common/stream/stream.h ../../../server/../common/sql_types.h ../../../server/../common/sql_backend.h ../../../server/../include/sql_catalog.h ../../../server/../include/sql_relation.h ../../../server/../storage/sql_storage.h ../../../server/../include/sql_keyword.h ../../../server/sql_atom.h ../../../server/../../clients/mapilib/mapi.h ../../../common/sql_backend.h ../../../common/../include/sql_mem.h ../../../common/../include/sql_catalog.h ../../../common/../include/sql_relation.h ../../../common/sql_types.h ../../../common/../include/sql_list.h ../../../common/sql_string.h ../../../common/../storage/sql_storage.h ../../../common/../../common/stream/stream.h ../../../../monetdb5/mal/mal_session.h ../../../../monetdb5/mal/mal_scenario.h ../../../../monetdb5/mal/mal_import.h ../../../../monetdb5/mal/mal_function.h ../../../../monetdb5/mal/mal_module.h ../../../../monetdb5/mal/mal_resolve.h ../../../../monetdb5/mal/mal_exception.h ../../../../monetdb5/mal/mal_instruction.h ../../../../monetdb5/mal/mal_type.h ../../../../monetdb5/mal/mal.h ../../../../monetdb5/mal/../../gdk/gdk.h ../../../../monetdb5/mal/mal_stack.h ../../../../monetdb5/mal/mal_properties.h ../../../../monetdb5/mal/mal_namespace.h ../../../../monetdb5/mal/mal_errors.h ../../../../monetdb5/mal/mal_interpreter.h ../../../../monetdb5/modules/mal/tablet.h ../../../../monetdb5/modules/atoms/streams.h ../../../../monetdb5/modules/atoms/../../mal/mal.h ../../../../monetdb5/modules/atoms/../../../common/stream/stream_socket.h ../../../../monetdb5/modules/atoms/mtime.h ../../../../monetdb5/modules/atoms/../../../gdk/gdk.h ../../../../monetdb5/modules/atoms/../../mal/mal_exception.h ../../../../monetdb5/modules/atoms/blob.h ../../../../monetdb5/modules/mal/mkey.h ../../../../monetdb5/modules/atoms/str.h ../../../server/sql_privileges.h ../../../server/sql_decimal.h ../../../server/sql_qc.h ../../../server/sql_symbol.h ../../../server/sql_env.h ../../../server/sql_parser.h ../sql_statement.h ../../../../monetdb5/modules/mal/querylog.h ../../../storage/bat/bat_storage.h ../../../storage/bat/bat_utils.h ../sql_cast.h ../sql.h udf_impl.h
+	$(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(lib_udf_la_CFLAGS) $(CFLAGS) $(udf-cg_CFLAGS) -c -o lib_udf_la-udf-cg.lo `test -f 'udf-cg.c' || echo '$(srcdir)/'`udf-cg.c
 dist-hook:
 	mkdir -p $(distdir)/Tests
 	cp -pR $(srcdir)/Tests/* $(distdir)/Tests
diff -rupN UDF.ori/Makefile.msc UDF/Makefile.msc
--- UDF.ori/Makefile.msc	2014-07-25 15:10:12.000000000 +0200
+++ UDF/Makefile.msc	2014-10-10 19:37:00.385271462 +0200
@@ -19,7 +19,7 @@ udf.mal: "$(srcdir)\udf.mal"
 	$(INSTALL) "$(srcdir)\80_udf.sql" "80_udf.sql"
 lib_udf.dll:  ..\..\..\..\monetdb5\tools\libmonetdb5.lib ..\..\..\..\gdk\libbat.lib
 lib_udf_LIBS = ..\..\..\..\monetdb5\tools\libmonetdb5.lib ..\..\..\..\gdk\libbat.lib
-lib_udf_OBJS = udf.obj
+lib_udf_OBJS = udf.obj udf-cg.obj
 lib_udf_DEPS = $(lib_udf_OBJS)
 lib_udf.lib: lib_udf.dll
 lib_udf.dll: $(lib_udf_DEPS) 
@@ -32,6 +32,8 @@ $(lib_udf_LIBS)
 	if not exist .libs $(MKDIR) .libs
 	$(INSTALL) "lib_udf.dll" ".libs\lib_udf.dll"
 
+udf-cg.obj: "$(srcdir)\udf-cg.c" "$(srcdir)\udf-cg.h" "$(srcdir)\..\..\..\include\sql_mem.h" "$(srcdir)\..\mal_backend.h" "$(srcdir)\..\..\..\server\sql_mvc.h" "$(srcdir)\..\..\..\server\..\include\sql_mem.h" "$(srcdir)\..\..\..\server\..\..\gdk\gdk.h" "$(srcdir)\..\..\..\server\sql_scan.h" "$(srcdir)\..\..\..\server\..\include\sql_list.h" "$(srcdir)\..\..\..\server\..\..\common\stream\stream.h" "$(srcdir)\..\..\..\server\..\common\sql_types.h" "$(srcdir)\..\..\..\server\..\common\sql_backend.h" "$(srcdir)\..\..\..\server\..\include\sql_catalog.h" "$(srcdir)\..\..\..\server\..\include\sql_relation.h" "$(srcdir)\..\..\..\server\..\storage\sql_storage.h" "$(srcdir)\..\..\..\server\..\include\sql_keyword.h" "$(srcdir)\..\..\..\server\sql_atom.h" "$(srcdir)\..\..\..\server\..\..\clients\mapilib\mapi.h" "$(srcdir)\..\..\..\common\sql_backend.h" "$(srcdir)\..\..\..\common\..\include\sql_mem.h" "$(srcdir)\..\..\..\common\..\include\sql_catalog.h" "$(srcdir)\..\..\..\common\..\include\sql_relation.h" "$(srcdir)\..\..\..\common\sql_types.h" "$(srcdir)\..\..\..\common\..\include\sql_list.h" "$(srcdir)\..\..\..\common\sql_string.h" "$(srcdir)\..\..\..\common\..\storage\sql_storage.h" "$(srcdir)\..\..\..\common\..\..\common\stream\stream.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_session.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_scenario.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_import.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_function.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_module.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_resolve.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_exception.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_instruction.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_type.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal.h" "$(srcdir)\..\..\..\..\monetdb5\mal\..\..\gdk\gdk.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_stack.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_properties.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_namespace.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_errors.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_interpreter.h" "$(srcdir)\..\..\..\..\monetdb5\modules\mal\tablet.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\streams.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\..\..\mal\mal.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\..\..\..\common\stream\stream_socket.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\mtime.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\..\..\..\gdk\gdk.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\..\..\mal\mal_exception.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\blob.h" "$(srcdir)\..\..\..\..\monetdb5\modules\mal\mkey.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\str.h" "$(srcdir)\..\..\..\server\sql_privileges.h" "$(srcdir)\..\..\..\server\sql_decimal.h" "$(srcdir)\..\..\..\server\sql_qc.h" "$(srcdir)\..\..\..\server\sql_symbol.h" "$(srcdir)\..\..\..\server\sql_env.h" "$(srcdir)\..\..\..\server\sql_parser.h" "$(srcdir)\..\sql_statement.h" "$(srcdir)\..\..\..\..\monetdb5\modules\mal\querylog.h" "$(srcdir)\..\..\..\storage\bat\bat_storage.h" "$(srcdir)\..\..\..\storage\bat\bat_utils.h" "$(srcdir)\..\sql_cast.h" "$(srcdir)\..\sql.h" "$(srcdir)\udf_impl.h"
+	$(CC) $(CFLAGS) $(udf-cg_CFLAGS) $(GENDLL) -D_CRT_SECURE_NO_WARNINGS -DLIBUDF -Fo"udf-cg.obj" -c "$(srcdir)\udf-cg.c"
 udf.obj: "$(srcdir)\udf.c" "$(srcdir)\udf.h" "$(srcdir)\..\..\..\include\sql_mem.h" "$(srcdir)\..\mal_backend.h" "$(srcdir)\..\..\..\server\sql_mvc.h" "$(srcdir)\..\..\..\server\..\include\sql_mem.h" "$(srcdir)\..\..\..\server\..\..\gdk\gdk.h" "$(srcdir)\..\..\..\server\sql_scan.h" "$(srcdir)\..\..\..\server\..\include\sql_list.h" "$(srcdir)\..\..\..\server\..\..\common\stream\stream.h" "$(srcdir)\..\..\..\server\..\common\sql_types.h" "$(srcdir)\..\..\..\server\..\common\sql_backend.h" "$(srcdir)\..\..\..\server\..\include\sql_catalog.h" "$(srcdir)\..\..\..\server\..\include\sql_relation.h" "$(srcdir)\..\..\..\server\..\storage\sql_storage.h" "$(srcdir)\..\..\..\server\..\include\sql_keyword.h" "$(srcdir)\..\..\..\server\sql_atom.h" "$(srcdir)\..\..\..\server\..\..\clients\mapilib\mapi.h" "$(srcdir)\..\..\..\common\sql_backend.h" "$(srcdir)\..\..\..\common\..\include\sql_mem.h" "$(srcdir)\..\..\..\common\..\include\sql_catalog.h" "$(srcdir)\..\..\..\common\..\include\sql_relation.h" "$(srcdir)\..\..\..\common\sql_types.h" "$(srcdir)\..\..\..\common\..\include\sql_list.h" "$(srcdir)\..\..\..\common\sql_string.h" "$(srcdir)\..\..\..\common\..\storage\sql_storage.h" "$(srcdir)\..\..\..\common\..\..\common\stream\stream.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_session.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_scenario.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_import.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_function.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_module.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_resolve.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_exception.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_instruction.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_type.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal.h" "$(srcdir)\..\..\..\..\monetdb5\mal\..\..\gdk\gdk.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_stack.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_properties.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_namespace.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_errors.h" "$(srcdir)\..\..\..\..\monetdb5\mal\mal_interpreter.h" "$(srcdir)\..\..\..\..\monetdb5\modules\mal\tablet.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\streams.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\..\..\mal\mal.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\..\..\..\common\stream\stream_socket.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\mtime.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\..\..\..\gdk\gdk.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\..\..\mal\mal_exception.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\blob.h" "$(srcdir)\..\..\..\..\monetdb5\modules\mal\mkey.h" "$(srcdir)\..\..\..\..\monetdb5\modules\atoms\str.h" "$(srcdir)\..\..\..\server\sql_privileges.h" "$(srcdir)\..\..\..\server\sql_decimal.h" "$(srcdir)\..\..\..\server\sql_qc.h" "$(srcdir)\..\..\..\server\sql_symbol.h" "$(srcdir)\..\..\..\server\sql_env.h" "$(srcdir)\..\..\..\server\sql_parser.h" "$(srcdir)\..\sql_statement.h" "$(srcdir)\..\..\..\..\monetdb5\modules\mal\querylog.h" "$(srcdir)\..\..\..\storage\bat\bat_storage.h" "$(srcdir)\..\..\..\storage\bat\bat_utils.h" "$(srcdir)\..\sql_cast.h" "$(srcdir)\..\sql.h" "$(srcdir)\udf_impl.h"
 	$(CC) $(CFLAGS) $(udf_CFLAGS) $(GENDLL) -D_CRT_SECURE_NO_WARNINGS -DLIBUDF -Fo"udf.obj" -c "$(srcdir)\udf.c"
 all-msc: "lib_udf.dll" "80_udf.mal" "udf.mal" "80_udf.sql"
diff -rupN UDF.ori/udf.mal UDF/udf.mal
--- UDF.ori/udf.mal	2014-01-14 09:56:23.000000000 +0100
+++ UDF/udf.mal	2014-10-10 19:38:20.522274591 +0200
@@ -22,6 +22,14 @@ command reverse(ra1:str):str
 address UDFreverse
 comment "Reverse a string";
 
+command lmin(ra1:str):str
+address UDFlmin
+comment "minimum of list";
+
+command lmax(ra1:str):str
+address UDFlmax
+comment "maximum of list";
+
 
 # BAT MAL signatures
 module batudf;
@@ -30,6 +38,14 @@ command reverse(b:bat[:oid,:str]):bat[:o
 address UDFBATreverse
 comment "Reverse a BAT of strings";
 
+#command lmin(b:bat[:oid,:str]):bat[:oid,:dbl]
+#address UDFBATlmin
+#comment "minimum of a BAT of lists";
+
+#command lmax(b:bat[:oid,:str]):bat[:oid,:dbl]
+#address UDFBATlmax
+#comment "maximum of a BAT of lists";
+
 
 
 # scalar MAL signatures
